{% extends "base.html" %}

{% block title %}Panel Trabajadores - Sistema de Clientes{% endblock %}

{% block content %}
<!-- ğŸ”¥ NUEVA INTERFAZ GOOGLE MAPS STYLE - PANTALLA COMPLETA -->
<div class="trabajadores-fullscreen">

    <!-- ğŸ”¥ BUSCADOR FLOTANTE SUPERIOR - ESTILO GOOGLE MAPS -->
    <div class="floating-search-container">
        <div class="floating-search-box">
            <div class="input-group">
                <input type="text" 
                    class="form-control form-control-lg" 
                    id="buscador-clientes" 
                    placeholder="ğŸ” Buscar cliente..."
                    autocomplete="off">
                <button class="btn btn-warning btn-lg" id="btn-actualizar-ubicacion"
                        title="Actualizar GPS">
                    ğŸš€ GPS
                </button>
            </div>
            
            <!-- CONTENEDOR DE SUGERENCIAS FLOTANTE -->
            <div class="sugerencias-dropdown floating-sugerencias" id="sugerencias-container-trabajadores">
                <div id="lista-sugerencias-trabajadores">
                    <!-- Las sugerencias se cargarÃ¡n aquÃ­ -->
                </div>
            </div>
        </div>
    </div>

    <!-- ğŸ”¥ BOTÃ“N VOLVER A MI UBICACIÃ“N FLOTANTE -->
    <button class="btn btn-success btn-floating-location d-none" id="btn-volver-ubicacion">
        ğŸ“ Mi UbicaciÃ³n
    </button>

    <!-- ğŸ”¥ MAPA 100% PANTALLA COMPLETA -->
    <div id="map-trabajadores" class="fullscreen-map"></div>

    <!-- ğŸ”¥ PANEL DE RESULTADOS FLOTANTE -->
    <div class="floating-results-card" id="panel-resultados" style="display: none;">
        <div class="floating-results-header">
            <h6 class="mb-0">ğŸ“‹ Resultados de BÃºsqueda</h6>
            <button type="button" class="btn-close btn-close-white" id="btn-cerrar-resultados"></button>
        </div>
        <div class="floating-results-body">
            <div id="lista-resultados">
                <!-- Los resultados se cargarÃ¡n aquÃ­ -->
            </div>
        </div>
    </div>

    <!-- ğŸ”¥ ESTADO GPS FLOTANTE PEQUEÃ‘O -->
    <div class="floating-status" id="estado-ubicacion-floating">
        <small>ğŸ“ Iniciando GPS...</small>
    </div>
</div>

<!-- ğŸ”¥ MODAL DE INFORMACIÃ“N DEL CLIENTE (SE MANTIENE IGUAL) -->
<div class="modal fade" id="infoClienteModal" tabindex="-1" aria-labelledby="modal-cliente-nombre" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modal-cliente-nombre">Cliente</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
            </div>
            <div class="modal-body">
                <div class="cliente-info">
                    <div class="d-flex align-items-center mb-3">
                        <div class="flex-shrink-0">
                            <span class="fs-4">ğŸ‘¨â€ğŸ’¼</span>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <h5 class="modal-cliente-nombre mb-1" id="modal-cliente-nombre">Cliente</h5>
                            <span class="badge bg-primary" id="modal-cliente-categoria">-</span>
                        </div>
                    </div>
                    
                    <div class="cliente-detalles">
                        <div class="detalle-item mb-2">
                            <small class="text-muted">ğŸ“ TelÃ©fono</small>
                            <div class="fw-medium" id="modal-cliente-telefono">No disponible</div>
                        </div>
                        
                        <div class="detalle-item mb-3">
                            <small class="text-muted">ğŸ“ DirecciÃ³n</small>
                            <div class="fw-medium text-break" id="modal-cliente-direccion">No disponible</div>
                        </div>
                    </div>
                </div>
                
                <div class="modal-footer bg-transparent border-0 pt-3">
                    <button class="btn btn-primary btn-lg w-100 py-2" id="btn-abrir-maps">
                        ğŸ—ºï¸ Abrir en Google Maps
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/map.js') }}"></script>
<script src="{{ url_for('static', filename='js/trabajadores.js') }}"></script>
{% endblock %}